import requests
import re
from matplotlib import pyplot as plt
from datetime import datetime
import pandas as pd
import csv
import os
import time

def get_url(i):
    headers = {"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",
               "Cookie":"BIDUPSID=A3EC28B157CCDE70F90361CD6BC247BD; PSTM=1612321919; BAIDUID=A3EC28B157CCDE70D521CA84FAF3492F:FG=1; __yjs_duid=1_1aeb9788e1cd2cf819b07d679d2f30591621152910146; H_WISE_SIDS=107318_110085_127969_128699_131861_164852_164869_170704_171234_176551_176677_177370_177413_177479_178329_178530_178610_179200_179346_179379_179402_179428_180109_180276_180327_180409_180434_180435_180512_180655_180756_180863_180869_181125_181218_181260_181327_181398_181428_181432_181482_181536_181546_181588_181646_181730_181790_181808_181864_181873_182000_182076_182193_182235_182297_182382_182484_182530_182596_182597_182921_182930_183328; BDUSS=jRNY3JzMFZxZVM2aWllVkdKVFZLNzBDa0tvMXVjMDB3cVFVNH41S3FsV2VPbDVoRVFBQUFBJCQAAAAAAAAAAAEAAABMCdMw6eRTQU~KyNGqAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ6tNmGerTZhV; BDUSS_BFESS=jRNY3JzMFZxZVM2aWllVkdKVFZLNzBDa0tvMXVjMDB3cVFVNH41S3FsV2VPbDVoRVFBQUFBJCQAAAAAAAAAAAEAAABMCdMw6eRTQU~KyNGqAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ6tNmGerTZhV; MCITY=-2912%3A; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; BDSFRCVID_BFESS=F7kOJexroG0vvIJHuvdlheFCg7GM4w5TDYLECrZpZjg7KlFVgVdREG0PtjJ5HU4bLrA9ogKKWmOTH7kF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF_BFESS=tbujoK-KtKt3f-op-P__jj_qhUKX5-RLfKov5l7F5l8-hxcvDPJR5xk0WhoEaPQlbm7LabDM0KOxOKQphnrxetA_QNob-CrXaa5uaf3N3KJmb-P9bT3v5tjB3GJq2-biWavL2MbdJbvP_IoG2Mn8M4bb3qOpBtQmJeTxoUJ25DnJhbLGe6K5D553DN-fqbbfb-oEBnTM2Ru_Hn7zeUkaXM4pbq7H2M-jbjcAaqnaJpF2jb5D5f-bQUr35Non0pcr3m7HhtJu2J0bOnRD34J4bhDkQN3T-PTZJmbP_no1-qDBDn3oypJVXp0njgcly5jtMgOBBJ0yQ4b4OR5JjxonDh83bG7MJUutfJueoIL2tK8bbP365IT0M-FQMfIX5-RLfbbiLp7F54nKDp0x5Rjzyxk00hOIaPQlbmA82D-yQncxsMTsQfbKWR8lMxtfB-7lQDvp0UoN3KJmf-DmyR0We-DTK4L82-biWavL2MbdJ56P_IoG2Mn8M4bb3qOpBtQmJeTxoUJ25DnJhhCGe6K5D553DN-fq-jeHDrKBRbaHJOoDDvphUrcy4LbKxnxJn5qWR77L4QeannqslOTjUJYjbb03-OkWn39babTQ-tbBp3k8MQT34OCQfbQ0hOBBjQ7QRna2PopfR7JOpv5hfnxy5-fQRPH-Rv92DQMVU52QqcqEIQHQT3m5-5bbN3ut6IHtb4q_I8bJKvbfP0k247EK-FHqxby26nlJK39aJ5y-J7nh-QCyf615JKOhM7-0fJMJ2vu_P0aQpbZ8h5JKl62W4IsjPRQ0q5MQDnNKl0MLPb8OC5S3jODXbDFefnMBMnUamOnaI3o3fAKftnOM46JehL3346-35543bRTLnLy5KJYMDcnK4-Xj6OyeaoP; Hm_lvt_55b574651fcae74b0a9f1cf9c8d7c93a=1636512112,1636702933,1637130534,1637223760; BAIDUID_BFESS=348867AF3EDCB1603B2E8BE4D2232421:FG=1; BDRCVFR[feWj1Vr5u3D]=I67x6TjHwwYf0; delPer=0; PSINO=3; H_PS_PSSID=34440_35106_35097_34584_34505_34532_35233_34579_34606_26350_35114; BA_HECTOR=8l2g8h0l208ka024nk1gpf1ju0q; baikeVisitId=afbc24b0-77f8-4b07-bede-3f896fd64818; ab_sr=1.0.1_YmIwNGU1N2VhMWUxMWEzMTdjMDhkZmFhMzZlNjcyNGI4MWYwYTY1NzBlNTg0OTJjYjhlODRhYThhNDFkODdmYTViNTM4NTlhODEwOWQwY2FkYjBhYWY3MmY0OTI3MWYwNjNmNzk0MzliNzEzYmQ3MTE0NWNhMTBjZGQwZDc0MGRhMjk5ZjBhMDBjMjMzNGJjYWQyZDJjMjQxYjA4ZDA2NzljM2JhN2UzOTE5NjJhYmViMDMxODFkMDg1MjJiMDU4",
               "Referer":"https://baike.baidu.com/historylist/%E4%B8%87%E7%A7%91/6141470",
               "Host": "baike.baidu.com",
               }
    url = "https://baike.baidu.com/api/wikiui/gethistorylist?tk=2499614627619ddcc873bc1c6160c771&lemmaId=6141470&from=" + str(i) + "&count=1&size=26"
    res = requests.get(url=url,headers=headers)
    res = res.content.decode('utf-8')
    createTime = re.findall(re.compile('"createTime":(\d+),'),res)
    userNames = re.findall(re.compile('"uname":"(.*?)"'),res)
    # for userName in userNames:
        # print(userName.encode('utf-8').decode('unicode_escape'))
    # print(createTime)
    time_list = []
    for date in createTime:
        st = time.localtime(int(date))
        truetime = time.strftime('%Z %Y-%B-%d %H:%M:%S',st)
        print(truetime)
        # time_list.append(truetime)

if __name__ == '__main__':
    for i in range(1,12):
        get_url(i)